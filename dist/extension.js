(()=>{"use strict";var t={306:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.parseRule=void 0;const i=r(496);class o{constructor(t,e,r,i,o,n){this.protocol=t,this.direction=e,this.source=r,this.sourcePort=i,this.destination=o,this.destinationPort=n}toRule(){return`${this.protocol} ${this.source} ${this.sourcePort} ${this.direction} ${this.destination} ${this.destinationPort}`}}class n{constructor(t,e){this.keyword=t,this.setting=e}toRule(){let t=i.workspace.getConfiguration().get("suricata.formatSpaceAfterSemicolomnInOption")?" ":"";return this.setting?`${this.keyword}:${t}${this.setting}`:`${this.keyword}`}}class s{constructor(t,e,r){this.action=t,this.header=e,this.options=r}toRule(){let t=i.workspace.getConfiguration().get("suricata.formatSpaceAfterOption")?" ":"",e=i.workspace.getConfiguration().get("suricata.formatSpaceAfterLastOption")?" ":"";return`${this.action} ${this.header.toRule()} (${this.options.map((t=>t.toRule())).join(`;${t}`)};${e})`}}e.parseRule=function(t){let e=function(t){let e=t.trim().indexOf(" ");if(e<=0)throw new Error("Invalid rule: no action found!");return t.substring(0,e).trim()}(t),r=function(t){let e=(t=t.trim()).indexOf(" "),r=t.indexOf(" ",e+1),i=t.indexOf("(");if(null===i)throw new Error("Invalid rule: no action found!");let n=t.substring(e,r).trim();var s,a,u;if((t=t.substring(r,i).trim()).indexOf("->")>0)[s,a]=t.split("->"),u="->";else{if(!(t.indexOf("<>")>0))throw new Error("Invalid rule: no direction found");[s,a]=t.split("<>"),u="<>"}let[l,c]=s.trim().split(" "),[d,f]=a.trim().split(" ");return new o(n,u,l.trim(),c.trim(),d.trim(),f.trim())}(t),i=function(t){let e=t.match(/[^\\]\(.+[^\\]\)/g);if(null===e)throw new Error("Invalid rule: no options found!");let r=e[0].trim().substring(1,e[0].length-2).trim().split(";");return r.pop(),r.map((t=>{if(t.indexOf(":")>0){let e=t.indexOf(":"),r=t.substring(0,e),i=t.substring(e+1);return new n(r.trim(),i.trim())}return new n(t.trim())}))}(t);return new s(e,r,i)}},496:t=>{t.exports=require("vscode")}},e={};function r(i){var o=e[i];if(void 0!==o)return o.exports;var n=e[i]={exports:{}};return t[i](n,n.exports,r),n.exports}var i={};(()=>{var t=i;Object.defineProperty(t,"__esModule",{value:!0}),t.activate=void 0;const e=r(496),o=r(306);t.activate=function(t){console.log("Meerkat is active!");let r=e.commands.registerCommand("meerkat.hello",(()=>{e.window.showInformationMessage("Meerkat: Hi!")}));t.subscriptions.push(r)},e.languages.registerDocumentFormattingEditProvider("suricata",{provideDocumentFormattingEdits(t){var r,i=[],n=[];if(e.workspace.getConfiguration().get("suricata.formatActiveLineOnly")){let t=e.window.activeTextEditor;if(!t)return e.window.showErrorMessage("Meerkat: Please select a line to format first"),[];r=Array.from([t.selection.active.line]).values()}else r=Array(t.lineCount).keys();for(const s of r){let r=t.lineAt(s);try{if(0===r.text.length||r.text.startsWith("#"))continue;let t=(0,o.parseRule)(r.text);i.push(e.TextEdit.replace(r.range,t.toRule()))}catch(t){n.push(s)}}return 0!==n.length?e.window.showErrorMessage(`Meerkat: Could not parse rules on lines [${n}]`):e.window.showInformationMessage(`Meerkat: Successfully formatted ${i.length} lines`),i}})})(),module.exports=i})();